#!/bin/bash
root=`stack path --local-install-root`
exe=$root/bin/rhythmr
app=Rhythmr.app
app_template=$app-template

# if [ -e "$app" ]; then
#   echo $app already exists
#   exit 1
# fi

rm -rf dist
mkdir dist
#cp -r build/folder-template dist

cp -r build/app-template/$app_template ./dist/$app
cp $exe dist/$app/Contents/MacOS/rhythmr

mkdir -p dist/Rhythmr.app/Contents/Resources
./build/generate-icns build/icon.png dist/Rhythmr.app/Contents/Resources/Rhythmr.icns

cp -r 60smotown.rhythmr dist
cp -r koop-it-again.rhythmr dist

how=folder

case $how in
  zip)
    echo creating zip
    zip -r dist.zip dist
    rm -r dist
    ;;
  dmg)
    echo creating dmg
    hdiutil create -volname Rythmr -srcfolder dist -ov -format UDZO Rhythmr.dmg
    rm -r dist
    ;;
  folder)
    # Do nothing
esac
