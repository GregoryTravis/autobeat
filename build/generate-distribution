#!/bin/bash
root=`stack path --local-install-root`
exe=$root/bin/rhythmr
app=Rhythmr.app
app_template=$app-template

# if [ -e "$app" ]; then
#   echo $app already exists
#   exit 1
# fi

rm -rf dist
mkdir dist

cp -r build/app-template/$app_template ./dist/$app
cp $exe dist/$app/Contents/MacOS/rhythmr
./build/generate-icns
cp -r 60smotown.rhythmr dist
cp -r koop-it-again.rhythmr dist

how=zip

if [ "$how" = "zip" ]; then
  echo creating zip
  zip -r dist.zip dist
else
  echo creating dmg
  hdiutil create -volname Rythmr -srcfolder dist -ov -format UDZO Rhythmr.dmg
fi

rm -r dist
